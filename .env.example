# Immich API (required)
IMMICH_API_BASE=https://your-immich-instance.com/api
IMMICH_API_KEY=your_api_key_here

# Asset types to process: IMAGE, VIDEO, or IMAGE,VIDEO (default: IMAGE,VIDEO)
ASSET_TYPES=IMAGE,VIDEO

# Dry run - preview only without making changes (default: true)
DRY_RUN=true

# Concurrent workers (default: 1)
CONCURRENCY=1

# Max assets to process, 0 = unlimited (default: 0)
# Useful for testing with a small batch before running on the full library
# MAX_ASSETS=100

# Include archived/deleted assets (default: false)
INCLUDE_ARCHIVED=false
INCLUDE_DELETED=false

# Date filter (YYYY-MM-DD, optional)
# Example: only process photos from 2020-2023
FILTER_DATE_AFTER=2020-01-01
FILTER_DATE_BEFORE=2023-12-31

# Image encoding distance (JXL)
# 0 = mathematically lossless, 1 = visually lossless, higher = more compression/smaller files
# Note: JPEGs use cjxl lossless repack (distance is ignored). This applies to PNG, WebP, HEIC, AVIF, etc.
IMAGE_DISTANCE=1.0

# Retry distance when output is larger than input (higher = more compression)
IMAGE_DISTANCE_RETRY=2.0

# Video encoding (SVT-AV1)
VIDEO_CRF=36
VIDEO_PRESET=4
VIDEO_MAX_DIMENSION=1080
VIDEO_AUDIO_BITRATE=64k

# Retry CRF when output is larger than input (higher = more compression)
VIDEO_CRF_RETRY=40

# Retry behavior
# ENABLE_RETRY: Retry with more compression if output is larger (default: true)
# ACCEPT_RETRY_OUTPUT: Accept retry result even if still larger (default: false)
ENABLE_RETRY=true
ACCEPT_RETRY_OUTPUT=false

# Safety
# ALLOW_LARGER: Keep output even if larger than input (default: false)
ALLOW_LARGER=false

# Working directory for temp files (default: /work)
WORKDIR=/work
