services:
  immich-library-converter:
    # Option 1: Build locally (default)
    build: .
    image: immich-library-converter:local

    # Option 2: Use prebuilt image from GitHub Container Registry
    # Uncomment the line below and comment out the 'build' and 'image' lines above
    # image: ghcr.io/fabianwimberger/immich-convert-originals:main

    container_name: immich-library-converter
    env_file:
      - .env
    # Use host networking to access Immich on localhost.
    # If Immich is on a remote server, you can remove this and use the default bridge network.
    network_mode: host
    restart: "no"
    # ffmpeg and ImageMagick use shared memory for large frame buffers
    shm_size: 1G
    volumes:
      - ./work:/work
